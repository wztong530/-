{"remainingRequest":"e:\\0_Tedu_wzt\\web第四阶段\\VUEUI\\vue_app_0000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!e:\\0_Tedu_wzt\\web第四阶段\\VUEUI\\vue_app_0000\\vue_app_00\\src\\components\\tabbar\\ShopCart.vue?vue&type=style&index=0&id=1943d354&scoped=true&lang=css","dependencies":[{"path":"e:\\0_Tedu_wzt\\web第四阶段\\VUEUI\\vue_app_0000\\vue_app_00\\src\\components\\tabbar\\ShopCart.vue","mtime":1555592181946},{"path":"e:\\0_Tedu_wzt\\web第四阶段\\VUEUI\\vue_app_0000\\vue_app_00\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"e:\\0_Tedu_wzt\\web第四阶段\\VUEUI\\vue_app_0000\\vue_app_00\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1521907988000},{"path":"e:\\0_Tedu_wzt\\web第四阶段\\VUEUI\\vue_app_0000\\vue_app_00\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"e:\\0_Tedu_wzt\\web第四阶段\\VUEUI\\vue_app_0000\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853416000},{"path":"e:\\0_Tedu_wzt\\web第四阶段\\VUEUI\\vue_app_0000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.app-shopcart{\r\n    padding-top:40px;/*留出header*/\r\n    padding-bottom:50px;/*留出tabbar*/\r\n    overflow-x:hidden;\r\n  }\r\n",{"version":3,"sources":["ShopCart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyLA;AACA;AACA;AACA;AACA","file":"ShopCart.vue","sourceRoot":"src\\components\\tabbar","sourcesContent":["<template>\r\n<div class=\"app-shopcart\">\r\n  <mt-header fixed title=\"学子商城\"></mt-header>\r\n  <div class=\"mui-card\">\r\n    <div class=\"mui-card-header\">\r\n      全选<input type=\"checkbox\"  @change=\"selectAll\" :checked=\"allcb\">\r\n    </div>\r\n    <div class=\"mui-card-content\">\r\n      <div class=\"mui-card-content-inner\">\r\n        <ul class=\"mui-table-view\">\r\n          <li class=\"mui-table-view-cell mui-media\" v-for=\"(item,i) of list\" :key=\"item.id\">\r\n            <a href=\"javascript:;\">\r\n              <img class=\"mui-media-object mui-pull-left\" src=\"img/2.jpg\">\r\n              <div class=\"mui-media-body\">\r\n                <p class='mui-ellipsis'>\r\n                  <!-- 1.复选框 -->\r\n                  <input type=\"checkbox\" :checked=\"item.cb\" @change=\"modifyItem\" :data-i=\"i\">\r\n                  <!-- 2.商品名称 -->\r\n                  {{item.lname}}\r\n                  <!-- 3.商品价格 -->\r\n                  ¥{{item.price}}\r\n                  <!-- 4.删除按钮 -->\r\n                  <input type=\"button\" value=\"删除\" @click=\"removeItem\" :data-id=\"item.id\">\r\n                </p>\r\n              </div>\r\n            </a>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n    <div class=\"mui-card-footer\">\r\n      <input type=\"button\" value=\"删除选中商品\" @click=\"removeSelect\">\r\n    </div>\r\n  </div>\r\n  <my-footer></my-footer>\r\n</div>\r\n</template>\r\n<script>\r\nimport myFooter from \"@/components/Footer.vue\"\r\nexport default {\r\n  data(){\r\n    return{\r\n      list:[],\r\n      allcb:false//全选状态 默认未选中\r\n    }\r\n  },\r\n  created(){\r\n    this.loadMore();\r\n  },\r\n  methods:{\r\n    modifyItem(e){\r\n      // 功能:如果用户选中商品，将当前商品对应对象的cb=true\r\n      //     如果用户取消选中，将当前商品对应对象的cb=false\r\n      // 1.获取当前元素选中状态\r\n      var cb=e.target.checked;\r\n      // 2.获取当前元素对应商品对象\r\n      //2.1获取当前元素的下标\r\n      var i=e.target.dataset.i;\r\n      //2.1将数组下标对应对象的cb赋值为当前选中状态\r\n      this.list[i].cb=cb;\r\n      // 3.修改商品对象cb属性\r\n\r\n      //4.修改全选状态 true false\r\n      //4.1创建变量count保存累加和\r\n      var count=0;\r\n      //4.2创建循环遍历所有元素\r\n      for(var item of this.list){\r\n        //4.3获取cb 如果值等于true count++\r\n        if(item.cb){\r\n          count++;\r\n        }\r\n      }\r\n      //4.4如果count个数与数组长度一致\r\n      if(count==this.list.length){\r\n        //4.5将全选复选框选中\r\n        this.allcb=true;\r\n      }else{\r\n        //4.6否则清空全选复选框\r\n        this.allcb=false;\r\n      }\r\n    },\r\n    removeSelect(){\r\n      this.$messagebox.confirm(\"是否删除选中商品?\")\r\n      .then(action=>{\r\n        //1.获取用户选中商品\r\n        // 1.1创建变量保存删除商品的ids=\"\"\r\n        var ids=\"\";\r\n        // 1.2创建循环遍历数组\r\n        for(var item of this.list){\r\n          // 1.3如果当前元素cb:true\r\n          if(item.cb){\r\n            // 1.4获取当前元素的id 拼接字符串 ids+=\"1\"\r\n            ids+=item.id+\",\";\r\n          }\r\n        }\r\n        // -如果用户没有选中商品，停止删除操作\r\n        if(ids.length==0){\r\n          this.$toast(\"请选中您需要删除的商品！\");\r\n          return;\r\n        }\r\n        // -如果用户选中多个商品 1,2, 去除后面的逗号\r\n        ids=ids.substr(0,ids.length-1);\r\n        // console.log(ids);\r\n        // return;\r\n        // //2.创建变量保存ids\r\n        // var ids=\"16,17\";\r\n        //3.创建url，发送ajax /delM\r\n        var url=\"http://127.0.0.1:3000/delM?ids=\"+ids;\r\n        this.axios.get(url).then(res=>{\r\n          //4.接收服务器返回结果\r\n          //5.提示 删除成功 删除失败\r\n          if(res.data.code==1){\r\n            this.$toast(\"删除成功\")\r\n            this.loadMore();\r\n          }else{\r\n            this.$toast(\"删除失败\")\r\n          }\r\n        })\r\n      }).catch(result=>{});\r\n    },\r\n    selectAll(e){\r\n      //1.获取全选状态\r\n      var cb=e.target.checked;\r\n      //2.遍历所有商品\r\n      for(var item of this.list){\r\n        //3.将全选状态赋值给商品选中状态\r\n        item.cb=cb;\r\n      }\r\n      //4.修改全选状态\r\n      this.allcb=\r\n    },\r\n    removeItem(e){\r\n      this.$messagebox.confirm(\"是否删除?\")\r\n      .then(action=>{\r\n        //如果用户选择确定\r\n        //功能:删除指定商品\r\n        //1.获取商品编号\r\n        var id=e.target.dataset.id;\r\n        //2.创建变量url\r\n        var url=\"http://127.0.0.1:3000/removeCartItem?id=\"+id;\r\n        //3.发送ajax请求\r\n        this.axios.get(url).then(res=>{\r\n          //4.获取返回结果\r\n          //5.判断如果删除成功\r\n          if(res.data.code==1){\r\n            this.$toast(\"删除成功\");\r\n            //6.将当前商品对象删除\r\n            //数据库已经删除成功,网页内容显示新内容(删除后)\r\n            this.loadMore();\r\n          }else{\r\n            this.$toast(\"删除失败\");\r\n          }\r\n        })\r\n      }).catch(result=>{\r\n        //如果用户选择取消，不执行任何操作\r\n      })\r\n      \r\n    },\r\n    loadMore(){\r\n      // 1.创建变量url\r\n      var url=\"http://127.0.0.1:3000/getCart\";\r\n      // 2.发送ajax请求\r\n      this.axios.get(url).then(res=>{\r\n        // 3.获取服务器返回的数据\r\n        //console.log(res.data.data);\r\n        // 4.保存list\r\n        // 为数组元素添加属性cb，cb表示复选框状态\r\n        var rows=res.data.data;//原数组\r\n        // 创建循环遍历数组并添加属性\r\n        for(var item of rows){\r\n          item.cb=false;\r\n        }\r\n        // 将添加结果后的数组赋值给 list\r\n        this.list=rows;\r\n        // this.list=res.data.data;\r\n        // console.log(this.list);\r\n      })\r\n    }\r\n  },\r\n  components:{\r\n    myFooter\r\n  }\r\n}\r\n</script>\r\n<style scoped>\r\n.app-shopcart{\r\n    padding-top:40px;/*留出header*/\r\n    padding-bottom:50px;/*留出tabbar*/\r\n    overflow-x:hidden;\r\n  }\r\n</style>\r\n"]}]}